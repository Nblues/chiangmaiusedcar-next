# üîë ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á Facebook Access Token ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏

## ‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
```
Error: The session is invalid because the user logged out.
```
Token ‡πÄ‡∏Å‡πà‡∏≤‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß - ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

---

## üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: User Access Token (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ - ‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏Ç‡πâ‡∏≤ Graph API Explorer

1. ‡πÄ‡∏õ‡∏¥‡∏î: https://developers.facebook.com/tools/explorer/

2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Facebook App ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ "Graph API Explorer"

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: Generate Access Token

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **Generate Access Token** (‡∏õ‡∏∏‡πà‡∏°‡∏ü‡πâ‡∏≤)

2. ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Facebook Account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

3. ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï permissions (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° - ‡πÉ‡∏ä‡πâ default ‡πÑ‡∏î‡πâ)

4. Copy **Access Token** ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡πÅ‡∏õ‡∏•‡∏á Short-lived ‚Üí Long-lived Token

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà A: ‡πÉ‡∏ä‡πâ Graph API Explorer (‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)**

1. ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Graph API Explorer ‡πÄ‡∏î‡∏¥‡∏°
2. ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á Access Token ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° üîÑ **"‚ÑπÔ∏è Access Token Info"**
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• token
4. ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° **"Extend Access Token"** ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å
5. Token ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏ 60 ‡∏ß‡∏±‡∏ô)

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà B: ‡πÉ‡∏ä‡πâ API ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á**

```powershell
# ‡πÅ‡∏ó‡∏ô YOUR_APP_ID, YOUR_APP_SECRET, ‡πÅ‡∏•‡∏∞ SHORT_LIVED_TOKEN
$appId = "YOUR_APP_ID"
$appSecret = "YOUR_APP_SECRET"
$shortToken = "SHORT_LIVED_TOKEN"

$url = "https://graph.facebook.com/v21.0/oauth/access_token?grant_type=fb_exchange_token&client_id=$appId&client_secret=$appSecret&fb_exchange_token=$shortToken"

Invoke-RestMethod -Uri $url
```

Response ‡∏à‡∏∞‡πÑ‡∏î‡πâ:
```json
{
  "access_token": "EAAFmLEj...",  ‚Üê Token ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏¢‡∏∏‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
  "token_type": "bearer"
}
```

---

## üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Page Access Token (‡∏≠‡∏≤‡∏¢‡∏∏‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î!)

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ!**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Facebook Page (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: https://www.facebook.com/pages/create
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Facebook Page ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à "‡∏Ñ‡∏£‡∏π‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡∏ñ‡∏™‡∏ß‡∏¢"

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Facebook App

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: https://developers.facebook.com/apps
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Create App**
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Business** ‚Üí **Next**
4. ‡∏Å‡∏£‡∏≠‡∏Å:
   - App Display Name: `ChiangmaiUsedCar OG Scraper`
   - App Contact Email: ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **Create App**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏û‡∏¥‡πà‡∏° Product

1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ App Dashboard
2. ‡∏´‡∏≤ **Add a Product**
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° **"Facebook Login"**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: Get Page Access Token

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà: https://developers.facebook.com/tools/explorer/
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å App ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
3. ‡∏Ñ‡∏•‡∏¥‡∏Å **Generate Access Token**
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **"Get User Access Token"**
5. ‡πÄ‡∏û‡∏¥‡πà‡∏° Permissions:
   - ‚úÖ `pages_read_engagement`
   - ‚úÖ `pages_show_list`
6. ‡∏Ñ‡∏•‡∏¥‡∏Å **Generate Access Token**
7. ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Page Token (‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏!)

**‡πÉ‡∏ä‡πâ API ‡∏ô‡∏µ‡πâ:**

```powershell
# User Access Token ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏°‡∏≤
$userToken = "EAAFmLEj..."

# ‡∏î‡∏∂‡∏á list pages ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á
$pages = Invoke-RestMethod -Uri "https://graph.facebook.com/v21.0/me/accounts?access_token=$userToken"

# ‡πÅ‡∏™‡∏î‡∏á pages ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
$pages.data | Format-Table name, access_token, id

# ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å access_token ‡∏Ç‡∏≠‡∏á page "‡∏Ñ‡∏£‡∏π‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡∏ñ‡∏™‡∏ß‡∏¢"
# Token ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏!
```

---

## ‚ö° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏£‡πá‡∏ß: ‡πÉ‡∏ä‡πâ Access Token Tool

1. ‡πÄ‡∏õ‡∏¥‡∏î: https://developers.facebook.com/tools/accesstoken/

2. ‡∏î‡∏π‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô **"User Token"** ‡∏´‡∏£‡∏∑‡∏≠ **"Page Token"**

3. ‡∏Ñ‡∏•‡∏¥‡∏Å **Debug** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

4. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Page Token ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô:
   ```
   Expires: Never
   ```

5. Copy Token ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ

---

## üîß ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Token ‡πÉ‡∏ô Vercel

‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ Token ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß:

```powershell
# ‡∏•‡∏ö token ‡πÄ‡∏Å‡πà‡∏≤
vercel env rm FACEBOOK_GRAPH_ACCESS_TOKEN production --yes
vercel env rm FACEBOOK_GRAPH_ACCESS_TOKEN preview --yes
vercel env rm FACEBOOK_GRAPH_ACCESS_TOKEN development --yes

# ‡πÄ‡∏û‡∏¥‡πà‡∏° token ‡πÉ‡∏´‡∏°‡πà
vercel env add FACEBOOK_GRAPH_ACCESS_TOKEN production
# ‡πÉ‡∏™‡πà: EAAFmLEj... (token ‡πÉ‡∏´‡∏°‡πà)

vercel env add FACEBOOK_GRAPH_ACCESS_TOKEN preview
vercel env add FACEBOOK_GRAPH_ACCESS_TOKEN development

# Redeploy
vercel --prod --yes
```

---

## ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Token ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

```powershell
# Test API ‡∏î‡πâ‡∏ß‡∏¢ token ‡πÉ‡∏´‡∏°‡πà
$token = "EAAFmLEj..."  # Token ‡πÉ‡∏´‡∏°‡πà
$testUrl = "https://graph.facebook.com/v21.0/?id=https://www.chiangmaiusedcar.com&scrape=true&access_token=$token"

Invoke-RestMethod -Method POST -Uri $testUrl
```

‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ response ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ token ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ!

---

## üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

| ‡∏ß‡∏¥‡∏ò‡∏µ | ‡∏≠‡∏≤‡∏¢‡∏∏ Token | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ |
|------|-----------|---------|-------|
| User Token | 60 ‡∏ß‡∏±‡∏ô | ‚≠ê‚≠ê | ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö |
| **Page Token** | **‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏** | ‚≠ê‚≠ê‚≠ê | **‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥!** |

**Page Access Token ‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î** - ‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à!

---

## üÜò ‡∏ï‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤?

‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! üöÄ
